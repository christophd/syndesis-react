{"version":3,"sources":["modules/dashboard/pages/DashboardPage.tsx","modules/dashboard/DashboardApp.tsx"],"names":["getTimestamp","integration","updatedAt","createdAt","byTimestamp","a","b","aTimestamp","getConnectionHref","connection","concat","id","DashboardPage","react","api","_ref","integrationsData","data","hasIntegrations","hasData","integrationsError","error","_ref2","metricsData","_ref3","connectionsData","hasConnections","connectionsError","integrationStatesCount","items","reduce","counts","mi","stateCount","currentState","Object","objectSpread","defineProperty","Error","Pending","Published","Unpublished","recentlyUpdatedIntegrations","integrations","map","sort","slice","getRecentlyUpdatedIntegrations","topIntegrations","arguments","length","undefined","topIntegrationsArray","keys","key","count","miA","miB","index","findIndex","i","reverse","getTopIntegrations","es","ns","t","ui","linkToIntegrations","resolvers","list","linkToIntegrationCreation","create","start","selectStep","linkToConnections","connections","linkToConnectionCreation","selectConnector","integrationsOverview","data-testid","title","totalCount","ok","connectionsOverview","i18nTitle","connectionsForDisplay","messagesOverview","messages","errors","uptimeOverview","parseInt","i18nLast30Days","numberOfDays","i18nLast60Days","i18nLast90Days","components","loading","integrationBoard","runningIntegrations","pendingIntegrations","stoppedIntegrations","i18nIntegrationStatePending","i18nIntegrationStateRunning","i18nIntegrationStateStopped","i18nIntegrations","i18nTotal","integrationUpdates","utils","loaderChildren","errorChildren","shared","integrationName","name","integrationCurrentState","integrationDate","i18nError","i18nPublished","i18nUnpublished","connections_shared","i18nConnections","i18nLinkCreateConnection","i18nLinkCreateIntegration","i18nLinkToConnections","i18nLinkToIntegrations","DashboardApp","Switch","Route","path","this","props","baseurl","exact","component","React"],"mappings":"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","file":"static/js/Dashboard.707afc9d.chunk.js","sourcesContent":["import {\n  WithConnections,\n  WithIntegrationsMetrics,\n  WithMonitoredIntegrations,\n} from '@syndesis/api';\nimport {\n  Connection,\n  IntegrationOverview,\n  IntegrationWithOverview,\n} from '@syndesis/models';\nimport {\n  AggregatedMetricCard,\n  ConnectionsMetric,\n  Dashboard,\n  IntegrationBoard,\n  RecentUpdatesCard,\n  RecentUpdatesItem,\n  RecentUpdatesSkeleton,\n  TopIntegrationsCard,\n  UptimeMetric,\n} from '@syndesis/ui';\nimport { WithLoader } from '@syndesis/utils';\nimport * as React from 'react';\nimport { Translation } from 'react-i18next';\nimport { ApiError } from '../../../shared';\nimport { Connections } from '../../connections/shared';\nimport { Integrations } from '../../integrations/components';\nimport resolvers from '../../resolvers';\n\nexport interface IIntegrationCountsByState {\n  Error: number;\n  Pending: number;\n  Published: number;\n  Unpublished: number;\n}\n\nexport function getIntegrationsCountsByState(\n  integrations: IntegrationWithOverview[]\n): IIntegrationCountsByState {\n  return integrations.reduce(\n    (counts, mi) => {\n      const stateCount = counts[mi.integration.currentState!] || 0;\n      return {\n        ...counts,\n        [mi.integration.currentState!]: stateCount + 1,\n      };\n    },\n    {\n      Error: 0,\n      Pending: 0,\n      Published: 0,\n      Unpublished: 0,\n    } as IIntegrationCountsByState\n  );\n}\n\nexport function getTimestamp(integration: IntegrationOverview) {\n  return integration.updatedAt !== 0\n    ? integration.updatedAt\n    : integration.createdAt;\n}\n\nexport function byTimestamp(a: IntegrationOverview, b: IntegrationOverview) {\n  const aTimestamp = getTimestamp(a) || 0;\n  const bTimestamp = getTimestamp(b) || 0;\n  return bTimestamp - aTimestamp;\n}\n\nexport function getRecentlyUpdatedIntegrations(\n  integrations: IntegrationWithOverview[]\n): IntegrationOverview[] {\n  return integrations\n    .map(mi => mi.integration)\n    .sort(byTimestamp)\n    .slice(0, 5);\n}\n\nexport function getTopIntegrations(\n  integrations: IntegrationWithOverview[],\n  topIntegrations: { [name: string]: number } = {}\n): IntegrationWithOverview[] {\n  const topIntegrationsArray = Object.keys(topIntegrations)\n    .map(key => {\n      return {\n        count: topIntegrations[key],\n        id: key,\n      } as any;\n    })\n    .sort((a, b) => {\n      return b.count - a.count;\n    });\n\n  return integrations\n    .sort((miA, miB) => byTimestamp(miA.integration, miB.integration))\n    .sort((a, b) => {\n      const index = topIntegrationsArray.findIndex(\n        i => i.id === b.integration.id\n      );\n      return index === -1 ? topIntegrationsArray.length + 1 : index;\n    })\n    .reverse()\n    .slice(0, 5);\n}\n\nexport function getConnectionHref(connection: Connection) {\n  return `/connections/${connection.id}`;\n}\n\nexport default () => (\n  <WithMonitoredIntegrations>\n    {({\n      data: integrationsData,\n      hasData: hasIntegrations,\n      error: integrationsError,\n    }) => (\n      <WithIntegrationsMetrics>\n        {({ data: metricsData }) => (\n          <WithConnections>\n            {({\n              data: connectionsData,\n              hasData: hasConnections,\n              error: connectionsError,\n            }) => {\n              const integrationStatesCount = getIntegrationsCountsByState(\n                integrationsData.items\n              );\n              const recentlyUpdatedIntegrations = getRecentlyUpdatedIntegrations(\n                integrationsData.items\n              );\n              const topIntegrations = getTopIntegrations(\n                integrationsData.items,\n                metricsData.topIntegrations\n              );\n              return (\n                <Translation ns={['dashboard', 'integrations', 'shared']}>\n                  {t => (\n                    <Dashboard\n                      linkToIntegrations={resolvers.integrations.list()}\n                      linkToIntegrationCreation={resolvers.integrations.create.start.selectStep()}\n                      linkToConnections={resolvers.connections.connections()}\n                      linkToConnectionCreation={resolvers.connections.create.selectConnector()}\n                      integrationsOverview={\n                        <div data-testid=\"total-integrations\">\n                          <AggregatedMetricCard\n                            title={t('titleTotalIntegrations', {\n                              count: integrationsData.totalCount,\n                            })}\n                            ok={\n                              integrationsData.totalCount -\n                              integrationStatesCount.Error\n                            }\n                            error={integrationStatesCount.Error}\n                          />\n                        </div>\n                      }\n                      connectionsOverview={\n                        <div data-testid=\"total-connections\">\n                          <ConnectionsMetric\n                            i18nTitle={t('titleTotalConnections', {\n                              count:\n                                connectionsData.connectionsForDisplay.length,\n                            })}\n                          />\n                        </div>\n                      }\n                      messagesOverview={\n                        <div data-testid=\"total-messages\">\n                          <AggregatedMetricCard\n                            title={t('titleTotalMessages', {\n                              count: metricsData.messages,\n                            })}\n                            ok={metricsData.messages! - metricsData.errors!}\n                            error={metricsData.errors!}\n                          />\n                        </div>\n                      }\n                      uptimeOverview={\n                        <UptimeMetric\n                          start={parseInt(metricsData.start!, 10)}\n                          i18nTitle={t('titleUptimeMetric')}\n                        />\n                      }\n                      topIntegrations={\n                        <TopIntegrationsCard\n                          i18nTitle={t('titleTopIntegrations', {\n                            count: 5,\n                          })}\n                          i18nLast30Days={t('lastNumberOfDays', {\n                            numberOfDays: 30,\n                          })}\n                          i18nLast60Days={t('lastNumberOfDays', {\n                            numberOfDays: 60,\n                          })}\n                          i18nLast90Days={t('lastNumberOfDays', {\n                            numberOfDays: 90,\n                          })}\n                        >\n                          <Integrations\n                            error={integrationsError}\n                            loading={!hasIntegrations}\n                            integrations={topIntegrations}\n                          />\n                        </TopIntegrationsCard>\n                      }\n                      integrationBoard={\n                        <IntegrationBoard\n                          runningIntegrations={integrationStatesCount.Published}\n                          pendingIntegrations={integrationStatesCount.Pending}\n                          stoppedIntegrations={\n                            integrationStatesCount.Unpublished\n                          }\n                          i18nTitle={t('titleIntegrationBoard')}\n                          i18nIntegrationStatePending={t(\n                            'integrationStatePending'\n                          )}\n                          i18nIntegrationStateRunning={t(\n                            'integrationStateRunning'\n                          )}\n                          i18nIntegrationStateStopped={t(\n                            'integrationStateStopped'\n                          )}\n                          i18nIntegrations={t('shared:Integrations')}\n                          i18nTotal={t('shared:Total')}\n                        />\n                      }\n                      integrationUpdates={\n                        <RecentUpdatesCard\n                          i18nTitle={t('titleIntegrationUpdates')}\n                        >\n                          <WithLoader\n                            error={false}\n                            loading={!hasIntegrations}\n                            loaderChildren={<RecentUpdatesSkeleton />}\n                            errorChildren={<ApiError />}\n                          >\n                            {() =>\n                              recentlyUpdatedIntegrations.map(i => (\n                                <RecentUpdatesItem\n                                  key={i.id}\n                                  integrationName={i.name}\n                                  integrationCurrentState={i.currentState!}\n                                  integrationDate={i.updatedAt! || i.createdAt!}\n                                  i18nError={t('shared:Error')}\n                                  i18nPublished={t('shared:Published')}\n                                  i18nUnpublished={t('shared:Unpublished')}\n                                />\n                              ))\n                            }\n                          </WithLoader>\n                        </RecentUpdatesCard>\n                      }\n                      connections={\n                        <Connections\n                          error={connectionsError}\n                          loading={!hasConnections}\n                          connections={connectionsData.connectionsForDisplay}\n                          getConnectionHref={getConnectionHref}\n                        />\n                      }\n                      i18nConnections={t('shared:Connections')}\n                      i18nLinkCreateConnection={t(\n                        'shared:linkCreateConnection'\n                      )}\n                      i18nLinkCreateIntegration={t(\n                        'shared:linkCreateIntegration'\n                      )}\n                      i18nLinkToConnections={t('linkToConnections')}\n                      i18nLinkToIntegrations={t('linkToIntegrations')}\n                      i18nTitle={t('title')}\n                    />\n                  )}\n                </Translation>\n              );\n            }}\n          </WithConnections>\n        )}\n      </WithIntegrationsMetrics>\n    )}\n  </WithMonitoredIntegrations>\n);\n","import * as React from 'react';\nimport { Route, Switch } from 'react-router';\nimport DashboardPage from './pages/DashboardPage';\n\nexport interface IDashboardAppProps {\n  baseurl: string;\n}\n\nexport default class DashboardApp extends React.Component<IDashboardAppProps> {\n  public render() {\n    return (\n      <Switch>\n        <Route\n          path={this.props.baseurl}\n          exact={true}\n          component={DashboardPage}\n        />\n      </Switch>\n    );\n  }\n}\n"],"sourceRoot":""}